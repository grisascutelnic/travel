<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/output.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<style>
    .role-buttons .btn{
        margin-right: 5px;
    }
    .btn-scucces:hover {
        background-color: #eb1d51;
    }
</style>
<body class="font-primary">
<section class="w-full h-[100vh]  bg-header  bg-cover bg-no-repeat bg-center bg-color1 bg-blend-multiply bg-opacity-60 ">
    <section class="w-full flex flex-wrap justify-center ">
        <header
                class="w-[85%]  xl:w-[73%]  container hidden lg:flex justify-between h-[60px]  items-center py-[45px] border-b-[1px] border-white border-opacity-40">
            <figure class="w-[140px]">
                <img src="/img/just_logo.png" alt="logo" class="w-[100%]">
            </figure>
            <nav class="h-[100%] md:w-[70%]">
                <ul class="h-[100%] flex items-center gap-8 justify-end">
                    <li class="list-none  "><a class="decoration-none text-white hover:text-color3 transition-all duration-500"
                                               th:href="@{/index}">Home</a></li>
                    <li class="list-none"><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                             href="">About</a></li>
                    <li class="list-none "><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                              href="">Tours</a></li>
                    <li class="list-none"><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                             href="">Destination</a></li>
                    <li class="list-none "><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                              th:href="@{/login}">Login</a></li>
                    <li class="list-none"><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                             th:href="@{/register}">Register</a></li>
                    <li class="list-none"><a class="decoration-none text-white  hover:text-color3 transition-all duration-500"
                                             th:href="@{/users}" sec:authorize="hasRole('ROLE_ADMIN')">Users</a></li>
                </ul>
            </nav>
        </header>

        <!-- header for mobile -->
        <header
                class="w-[95%] sm:w-[70%] md:w-[80%] container flex h-[60px] justify-between  items-center  lg:hidden  py-[45px] relative border-b-[1px] border-white border-opacity-40 ">
            <figure class="w-[140px]">
                <img src="/img/logo-light.png" alt="" class="w-[100%]">
            </figure>
            <div class=" w-1/2 h-full flex justify-end items-center ">
                <i class="bi bi-list text-3xl text-white cursor-pointer ham-menu-icon"></i>
            </div>
            <nav class="menu hidden h-[400px] w-full absolute bg-white left-0 top-[90px]   z-30 ">
                <ul class="h-full w-full flex flex-col  justify-center ms-6">
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex hover:text-color4  transition-all duration-600"
                            href="">Home</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex  hover:text-color4  transition-all duration-600"
                            href="">About</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex  hover:text-color4 transition-all duration-600"
                            href="">Tours</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex  hover:text-color4 transition-all duration-600"
                            href="">Destination</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex   hover:text-color4  transition-all duration-600"
                            href="">Blog</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex  hover:text-color4  transition-all duration-600"
                            href="">Gallery</a></li>
                    <li class="list-none my-3"><a
                            class="decoration-none text-color2 flex   hover:text-color4 transition-all duration-600"
                            href="">Contact</a></li>
                </ul>
            </nav>
        </header>
        <!-- end header mobile  -->
    </section>

    <div class="container mt-4">
        <div class="row">
            <h1>Registered Users</h1>
        </div>
        <table class="table table-striped table-bordered table-hover" style="background-color: white">
            <thead class="table-dark">
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="user : ${users}">
                <td th:text="${user.firstName}"></td>
                <td th:text="${user.lastName}"></td>
                <td th:text="${user.email}"></td>

                <td>
                    <span th:each="role : ${user.roles}">
                        <span th:if="${role == 'ROLE_USER'}" class="btn btn-sm btn-secondary">User</span>
                        <span th:if="${role == 'ROLE_MOD'}" class="btn btn-sm btn-warning">Mod</span>
                        <span th:if="${role == 'ROLE_ADMIN'}" class="btn btn-sm"  style="background-color: #eb1d51">Admin</span>
                    </span>
                </td>
                <td class="role-buttons" th:each="role: ${user.roles}">

                    <form th:if="${role == 'ROLE_MOD' || role == 'ROLE_USER'}" th:action="@{/users/makeAdmin}" method="post" style="display:inline;">
                        <input type="hidden" name="id" th:value="${user.id}">
                        <button type="submit" class="btn btn-sm btn-scucces" style="color: black; border-color: #eb1d51;">Make Admin</button>
                    </form>

                    <form th:if="${role == 'ROLE_ADMIN' || role == 'ROLE_USER'}" th:action="@{/users/makeMod}" method="post" style="display:inline;">
                        <input type="hidden" name="id" th:value="${user.id}">
                        <button type="submit" class="btn btn-sm btn-warning">Make Mod</button>
                    </form>

                    <form th:if="${role == 'ROLE_ADMIN' || role == 'ROLE_MOD'}" th:action="@{/users/makeUser}" method="post" style="display:inline;">
                        <input type="hidden" name="id" th:value="${user.id}">
                        <button type="submit" class="btn btn-sm btn-secondary" style="color: black;">Make User</button>
                    </form>

                    <!--                    <span th:each="role : ${user.roles}">-->
<!--                        <button th:if="${role != 'ROLE_ADMIN'}" class="btn btn-sm"  style="background-color: #eb1d51" onclick="#admin">Make Admin</button>-->
<!--                        <button th:if="${role != 'ROLE_MOD'}" class="btn btn-sm btn-warning" onclick="#mod">Make Mod</button>-->
<!--                        <button th:if="${role != 'ROLE_USER'}" class="btn btn-sm btn-secondary" onclick="#user">Make User</button>-->
<!--                    </span>-->
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</section>
    <script src="/js/master.js"></script>
</body>
</html>
